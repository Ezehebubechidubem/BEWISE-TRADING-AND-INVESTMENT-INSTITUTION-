<!-- course.html (updated: removed files UI & logic; added top-right button that redirects to /files) -->  
<!doctype html>  
<html>    
<head>    
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">    
<title>Courses</title>    
<link rel="icon" href="https://i.postimg.cc/x1cLbZhh/IMG-20250812-WA0070.jpg">
<!-- Font Awesome for footer/social icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-pbV1Xg8m9y+6f1YQ8q6QfQFv2cY1X1V3b1Q6t1Gm2jZgkF6hI8f3Jk6jV6r1Q9Y2V6r1Q9Y2V6r1Q9Y2V6r1Q9==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<style>    
  body{font-family:system-ui;margin:0;background:linear-gradient(180deg,#031025,#071024);color:#e6eef8}    
  header{    
    display:flex;    
    align-items:center;    
    gap:12px;    
    padding:12px;    
    background:linear-gradient(90deg,#06203a,#08304d);    
  }    
  .brand{ display:flex; align-items:center; gap:12px; }    
  .logo{height:36px}    
  .wrap{padding:18px;max-width:1100px;margin:auto}    
  .intro{opacity:0.9;margin-bottom:14px}    
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:14px}    
  .card{background:#062035;padding:12px;border-radius:12px;position:relative;overflow:hidden}    
  video{width:100%;border-radius:8px;background:black}  /* top-right button styling */  
.header-actions{ margin-left:auto; display:flex; gap:8px; align-items:center; }  
.top-btn{  
padding:8px 12px;  
border-radius:10px;  
border:0;  
cursor:pointer;  
font-weight:800;  
font-size:0.95rem;  
background:linear-gradient(90deg,#06b6d4,#0891b2);  
color:#042a2b;  
box-shadow:0 8px 20px rgba(0,0,0,0.35);  
}  
.top-btn.secondary{ background:linear-gradient(90deg,#4ade80,#16a34a); color:#04210b; }  
footer{  
text-align: center;  
padding: 10px;  
background-color: green;  
border: 2px solid black;  
border-radius:12px;  
}  .social{
border:2px solid black;
padding:20px;
text-align:center;
border-radius:12px;
}

footer i {
margin: 1px;
font-size: 28px;
margin:15px;

}

/* Modal */
.modal-backdrop{ position:fixed; inset:0; background:rgba(2,6,23,0.6); display:none; align-items:center; justify-content:center; z-index:9999; }
.modal-panel{ background:#0b1220; padding:18px; border-radius:10px; width:92%; max-width:520px; box-shadow:0 12px 40px rgba(0,0,0,0.6); color:#e6eef8 }
.modal-title{ font-weight:800; margin-bottom:8px; font-size:1.05rem }
.modal-body{ margin-bottom:12px; color:#cfefff; line-height:1.3 }
.modal-actions{ display:flex; gap:8px; justify-content:flex-end; }
.btn-secondary{ background:transparent; border:1px solid rgba(255,255,255,0.06); color:#cfefff; padding:8px 10px; border-radius:8px; cursor:pointer }
.btn-primary{ background:linear-gradient(90deg,#06b6d4,#0891b2); color:#042a2b; padding:8px 12px; border-radius:8px; font-weight:800; cursor:pointer }

@media (max-width:520px){
.top-btn{ padding:8px 10px; font-size:0.9rem; }
}
</style>

</head>    
<body>    
<header>    
  <div class="brand">    
    <img src=" https://i.postimg.cc/x1cLbZhh/IMG-20250812-WA0070.jpg " class="logo" alt="logo">    
    <div style="font-weight:700; colour:green">BEWISE TRADING AND INVESTMENT INSTITUTION</div>    
  </div>    <!-- Top-right button requested -->    <div class="header-actions">    
    <!-- This button is a simple top-right action. It does NOT load files nor include file UI.    
         Adjust href or click behavior on the backend availability if you want it to link elsewhere. -->    
    <button id="topFilesBtn" class="top-btn" aria-label="Files">Files</button>    
  </div>    
</header>  <div class="wrap">    
  <p class="intro">Watch course videos below. Downloading is blocked (best-effort).</p>    <div id="grid" class="grid" aria-live="polite"></div>    
</div>  <!-- Modal (used instead of alerts) -->  <div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-hidden="true">    
  <div class="modal-panel" role="document" aria-live="polite" aria-modal="true">    
    <div class="modal-title" id="modalTitle">Title</div>    
    <div class="modal-body" id="modalBody">Message</div>    
    <div class="modal-actions" id="modalActions">    
      <button class="btn-secondary" id="modalCancel">Cancel</button>    
      <button class="btn-primary" id="modalOk">OK</button>    
    </div>    
  </div>    
</div>    
  <footer>    
    <div class="social">    
      <a href="https://facebook.com/profile.php?id=100081867991800" target="_blank"><i class="fab fa-facebook" style="color:#3b5998;"></i></a>    
      <a href="https://x.com/chidubemEz468?t=QhEOHmP-Gqc253LRMfbu_A&s=09" target="_blank"><i class="fab fa-twitter" style="color:#1DA1F2;"></i></a>    
      <a href="https://wa.me/qr/JYPUQLHYHEZAA1" target="_blank"><i class="fab fa-whatsapp" style="color:#25D366;"></i></a>    
      <a href="https://tiktok.com/@TraderDubem" target="_blank"><i class="fab fa-tiktok" style="color:#000;"></i></a>    
    </div><br>    
    <h3 style="color:black">&copy; Developed By Dubem Tech</h3>    
  </footer>  <script>    
(async function(){    
  // Modal utilities (replaces alert)    
  const backdrop = document.getElementById('modalBackdrop');    
  const titleEl = document.getElementById('modalTitle');    
  const bodyEl = document.getElementById('modalBody');    
  const okBtn = document.getElementById('modalOk');    
  const cancelBtn = document.getElementById('modalCancel');    
  function showModal(title, message, { showCancel=false, okText='OK', cancelText='Cancel' } = {}){    
    titleEl.innerText = title || '';    
    bodyEl.innerText = message || '';    
    okBtn.innerText = okText;    
    cancelBtn.innerText = cancelText;    
    cancelBtn.style.display = showCancel ? 'inline-block' : 'none';    
    backdrop.style.display = 'flex';    
    backdrop.setAttribute('aria-hidden','false');    
    return new Promise(resolve=>{    
      function cleanup(){ okBtn.removeEventListener('click', onOk); cancelBtn.removeEventListener('click', onCancel); backdrop.style.display='none'; backdrop.setAttribute('aria-hidden','true'); }    
      function onOk(){ cleanup(); resolve(true); }    
      function onCancel(){ cleanup(); resolve(false); }    
      okBtn.addEventListener('click', onOk);    
      cancelBtn.addEventListener('click', onCancel);    
    });    
  }    
  const showMessage = (t,m) => showModal(t,m,{showCancel:false,okText:'OK'});    
  const showConfirm = (t,m) => showModal(t,m,{showCancel:true,okText:'Yes',cancelText:'No'});    // compute fingerprint (unchanged)
async function computeFP(){
let uuid = localStorage.getItem('training_device_uuid');
if(!uuid){ uuid = crypto.randomUUID ? crypto.randomUUID() : ('u-'+Math.random().toString(36).slice(2)); localStorage.setItem('training_device_uuid', uuid); }
const data = [navigator.userAgent||'', navigator.platform||'', (navigator.languages||[]).join(','), screen.width+'x'+screen.height+'x'+screen.colorDepth, Intl.DateTimeFormat().resolvedOptions().timeZone||'', uuid].join('||');
const enc = new TextEncoder().encode(data);
const hashBuf = await crypto.subtle.digest('SHA-256', enc);
return Array.from(new Uint8Array(hashBuf)).map(b=>b.toString(16).padStart(2,'0')).join('');
}

const fp = await computeFP();
const allowed = localStorage.getItem('training_allowed_device');
if(allowed && allowed !== fp){
await showMessage('Device locked','This installation is locked to another device.');
location.href='/'; return;
}

// session check (unchanged)
try{
const chk = await (await fetch('/api/check_session')).json();
if(!chk.logged_in){ location.href='/'; return; }
}catch(e){
console.error('check_session failed',e);
await showMessage('Error','Unable to verify session. Redirecting to login.'); location.href='/'; return;
}

// helper to fetch JSON safely
async function safeJson(url, opts){ try { const r = await fetch(url, opts); if(!r.ok){ return {ok:false,status:r.status}; } const j = await r.json(); return {ok:true,body:j}; } catch(e){ return {ok:false,error:e}; } }

// UI refs
const grid = document.getElementById('grid');
const topFilesBtn = document.getElementById('topFilesBtn');

// load & render videos only
async function loadVideos(){
const res = await safeJson('/api/videos');
if(res.ok && Array.isArray(res.body)) return res.body;
return [];
}

function renderVideos(videos){
grid.innerHTML = '';
if(!Array.isArray(videos) || videos.length===0){
grid.innerHTML = '<div style="opacity:0.8">No videos yet.</div>'; return;
}
videos.forEach(v=>{
const card = document.createElement('div'); card.className='card';
const vid = document.createElement('video'); vid.controls=true; vid.setAttribute('controlsList','nodownload nofullscreen noremoteplayback'); vid.src = '/stream/'+v.id;
vid.onplay = async ()=>{ try { const j = await (await fetch('/api/check_session')).json(); if(!j.logged_in){ vid.pause(); await showMessage('Login required','Please login'); location.href='/'; } } catch(e){ vid.pause(); await showMessage('Error','Session check failed'); location.href='/'; } };
const t = document.createElement('div'); t.style.marginTop='8px'; t.style.fontWeight='700'; t.innerText = v.title || 'Untitled';
card.appendChild(vid); card.appendChild(t); grid.appendChild(card);
});
}

// initial load
const videos = await loadVideos();
renderVideos(videos);

// top-right button behavior: redirect to /files (per your request)
topFilesBtn.addEventListener('click', async ()=>{
window.location.href = '/files';
});

// protections & polish (unchanged)
document.addEventListener('contextmenu', e=>e.preventDefault());
document.addEventListener('visibilitychange', ()=>{ document.querySelectorAll('video').forEach(v=> v.style.filter = document.visibilityState === 'visible' ? 'none' : 'blur(6px)'); });

})();
</script>  </body>

</html>